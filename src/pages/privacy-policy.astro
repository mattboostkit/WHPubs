---
import Layout from '../layouts/Layout.astro';
import { getPrivacyPolicy } from '../lib/sanity';
import PrivacyPolicyContent from '../components/PrivacyPolicyContent';

// Get privacy policy for the main hub
const privacyPolicy = await getPrivacyPolicy();

if (!privacyPolicy) {
  return Astro.redirect('/404');
}

const lastUpdatedDate = privacyPolicy.lastUpdated 
  ? new Date(privacyPolicy.lastUpdated).toLocaleDateString('en-GB', {
      day: 'numeric',
      month: 'long',
      year: 'numeric'
    })
  : '';
---

<Layout title={privacyPolicy.title || 'Privacy Policy'}>
  <div class="bg-white py-16">
    <div class="container mx-auto px-4 max-w-4xl">
      <h1 class="text-4xl md:text-5xl font-serif text-center mb-8 text-primary">
        {privacyPolicy.title}
      </h1>
      
      {lastUpdatedDate && (
        <p class="text-center text-gray-600 mb-12">
          Last updated: {lastUpdatedDate}
        </p>
      )}
      
      <div class="prose prose-lg max-w-none privacy-content">
        {privacyPolicy.content && (
          <PrivacyPolicyContent content={privacyPolicy.content} client:load />
        )}
      </div>
    </div>
  </div>
</Layout>

<style>
  .privacy-content {
    @apply text-gray-700;
  }
  
  .privacy-content h1,
  .privacy-content h2,
  .privacy-content h3 {
    @apply text-primary;
  }
  
  .privacy-content a {
    @apply text-secondary hover:underline;
  }
</style>