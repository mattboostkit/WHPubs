---
import Layout from '@/layouts/Layout.astro';
import { getPubBySlug } from '@/lib/sanity';
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";

const targetPubSlug = import.meta.env.TARGET_PUB_SLUG;
const targetPub = targetPubSlug ? await getPubBySlug(targetPubSlug) : null;

const pageTitle = targetPub ? `Private Dining | ${targetPub.name}` : 'Private Dining - WH Pubs';
const pageDescription = targetPub 
  ? `Host your special event at ${targetPub.name}. From intimate gatherings to large celebrations, we offer bespoke private dining experiences.`
  : 'Host memorable events at WH Pubs with our private dining options. Intimate gatherings to large celebrations, we cater to every occasion.';

// Create structured data for the private dining page
const structuredData = {
  "@context": "https://schema.org",
  "@type": "Restaurant",
  "name": targetPub ? `${targetPub.name} Private Dining` : "WH Pubs Private Dining",
  "description": pageDescription,
  "url": targetPub ? `${targetPub.externalDomain}/private-dining` : "https://whpubs.com/private-dining"
};

// Define private dining options based on the pub
const privateDiningOptions = {
  'the-bull-otford': [
    {
      name: 'The Coaching Inn Room',
      capacity: '20-30 guests',
      description: 'Our historic private dining room with original features and modern amenities, perfect for business dinners and family celebrations.',
      features: ['Private bar area', 'AV equipment available', 'Exclusive entrance', 'Garden access']
    },
    {
      name: 'Garden Marquee',
      capacity: '40-80 guests',
      description: 'Beautiful outdoor marquee space in our beer garden, ideal for summer celebrations and wedding receptions.',
      features: ['Weather protection', 'Outdoor bar', 'Garden views', 'Dance floor available']
    }
  ],
  'the-cricketers-inn': [
    {
      name: 'The Orangery',
      capacity: '25-40 guests',
      description: 'Our stunning glass-walled Orangery provides natural light and garden views, creating the perfect ambiance for special occasions.',
      features: ['Natural lighting', 'Garden views', 'Climate controlled', 'Exclusive use']
    },
    {
      name: 'Village Hall Hire',
      capacity: '50-100 guests',
      description: 'Complete venue hire for larger celebrations, weddings, and corporate events with full use of our facilities.',
      features: ['Exclusive venue use', 'Full bar service', 'Kitchen facilities', 'Event coordination']
    }
  ],
  'the-chaser-inn': [
    {
      name: 'The Church Room',
      capacity: '15-25 guests',
      description: 'Our intimate private dining room with historic character, perfect for business meetings and family gatherings.',
      features: ['Historic features', 'Private entrance', 'Intimate setting', 'Flexible setup']
    },
    {
      name: 'Courtyard Dining',
      capacity: '30-50 guests',
      description: 'Semi-private outdoor dining in our charming courtyard, ideal for summer parties and celebrations.',
      features: ['Outdoor setting', 'Covered area', 'Garden atmosphere', 'Weather contingency']
    }
  ],
  'the-rose-and-crown': [
    {
      name: 'Tiki Hut Experience',
      capacity: '12-20 guests',
      description: 'Unique tropical-themed private dining in our exclusive Tiki Huts, perfect for birthdays and special celebrations.',
      features: ['Tropical theming', 'Cocktail service', 'Unique atmosphere', 'Photo opportunities']
    },
    {
      name: 'Garden Party Space',
      capacity: '40-80 guests',
      description: 'Extensive garden areas for larger celebrations with kids play area and multiple dining zones.',
      features: ['Family-friendly', 'Kids play area', 'Multiple zones', 'BBQ facilities']
    }
  ],
  'the-little-brown-jug': [
    {
      name: 'Countryside Retreat',
      capacity: '20-35 guests',
      description: 'Private dining with retractable roof and countryside views, adaptable for any weather or occasion.',
      features: ['Retractable roof', 'Countryside views', 'All-weather', 'Cozy atmosphere']
    },
    {
      name: 'Tiki Hut Hideaway',
      capacity: '10-16 guests',
      description: 'Intimate Tiki Hut setting perfect for small celebrations and romantic dining experiences.',
      features: ['Intimate setting', 'Romantic ambiance', 'Exclusive use', 'Cocktail menu']
    }
  ]
};

const options = targetPub ? privateDiningOptions[targetPub.slug.current] || [] : [];
---

<Layout title={pageTitle} description={pageDescription} pub={targetPub}>
  <!-- Add structured data -->
  <script type="application/ld+json" set:html={JSON.stringify(structuredData)} />
  
  <main>
    {!targetPub ? (
      <!-- Hub Site: General Private Dining -->
      <section class="relative h-[60vh] min-h-[500px] overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-br from-primary/90 to-primary/70"></div>
        <div class="absolute inset-0 bg-[url('/images/private-dining-hero.jpg')] bg-cover bg-center opacity-30"></div>
        <div class="relative z-10 h-full flex items-center">
          <div class="container mx-auto px-4 text-center text-white">
            <span class="inline-block px-4 py-1 bg-secondary/20 text-secondary rounded-full text-sm font-semibold uppercase tracking-wider mb-6">
              Private Dining
            </span>
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6">
              Create Unforgettable Memories
            </h1>
            <p class="text-xl lg:text-2xl mb-8 max-w-3xl mx-auto">
              Host your special occasion at one of our beautiful pubs with bespoke private dining experiences tailored to your needs.
            </p>
            <Button size="lg" className="bg-secondary text-primary hover:bg-secondary/90">
              <a href="/contact">Enquire Now</a>
            </Button>
          </div>
        </div>
      </section>
    ) : (
      <!-- Individual Pub Site: Pub-specific Private Dining -->
      <>
        <!-- Hero Section -->
        <section class="relative h-[60vh] min-h-[500px] overflow-hidden">
          <div class="absolute inset-0 bg-gradient-to-br from-primary/90 to-primary/70"></div>
          <div 
            class="absolute inset-0 bg-cover bg-center opacity-30"
            style={`background-image: url('${targetPub.heroImage?.asset?.url || '/images/private-dining-hero.jpg'}')`}
          ></div>
          <div class="relative z-10 h-full flex items-center">
            <div class="container mx-auto px-4 text-center text-white">
              <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6">
                Private Dining at {targetPub.name}
              </h1>
              <p class="text-xl lg:text-2xl mb-8 max-w-3xl mx-auto">
                Host your special celebration in our unique spaces with bespoke menus and exceptional service.
              </p>
              <div class="flex flex-wrap gap-4 justify-center">
                <Button size="lg" className="bg-secondary text-primary hover:bg-secondary/90">
                  <a href="/contact">Request a Quote</a>
                </Button>
                <Button variant="outline" size="lg" className="border-secondary text-secondary hover:bg-secondary hover:text-primary">
                  <a href="/book-table">Book a Table</a>
                </Button>
              </div>
            </div>
          </div>
        </section>

        <!-- Private Dining Options -->
        {options.length > 0 && (
          <section class="py-16 lg:py-20 bg-white">
            <div class="container mx-auto px-4">
              <div class="max-w-6xl mx-auto">
                <div class="text-center mb-12">
                  <span class="inline-block px-4 py-1 bg-secondary/10 text-secondary rounded-full text-sm font-semibold uppercase tracking-wider mb-4">
                    Our Spaces
                  </span>
                  <h2 class="text-3xl lg:text-4xl font-bold text-primary mb-6">
                    Perfect Spaces for Every Occasion
                  </h2>
                  <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                    From intimate gatherings to grand celebrations, we have the perfect space and menu to make your event unforgettable.
                  </p>
                </div>

                <div class="grid lg:grid-cols-2 gap-8">
                  {options.map((option, index) => (
                    <Card key={index} className="overflow-hidden hover:shadow-xl transition-all duration-300">
                      <CardHeader className="bg-gradient-to-r from-primary/5 to-secondary/5">
                        <CardTitle className="text-2xl text-primary mb-2">{option.name}</CardTitle>
                        <div className="flex items-center text-secondary font-semibold">
                          <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                          </svg>
                          {option.capacity}
                        </div>
                      </CardHeader>
                      <CardContent className="p-6">
                        <p className="text-gray-700 mb-6 leading-relaxed">{option.description}</p>
                        <div className="space-y-2">
                          <h4 className="font-semibold text-primary mb-3">Features include:</h4>
                          <ul className="space-y-2">
                            {option.features.map((feature, idx) => (
                              <li key={idx} className="flex items-center text-sm text-gray-600">
                                <svg className="w-4 h-4 mr-3 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                                </svg>
                                {feature}
                              </li>
                            ))}
                          </ul>
                        </div>
                      </CardContent>
                    </Card>
                  ))}
                </div>
              </div>
            </div>
          </section>
        )}
      </>
    )}

    <!-- What We Offer Section -->
    <section class="py-16 lg:py-20 bg-gray-50">
      <div class="container mx-auto px-4">
        <div class="max-w-6xl mx-auto">
          <div class="text-center mb-12">
            <h2 class="text-3xl lg:text-4xl font-bold text-primary mb-6">
              What We Offer
            </h2>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">
              Our private dining experiences are tailored to make your event perfect, with attention to every detail.
            </p>
          </div>

          <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
            <div class="text-center">
              <div class="w-16 h-16 bg-secondary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                </svg>
              </div>
              <h3 class="text-xl font-bold text-primary mb-3">Bespoke Menus</h3>
              <p class="text-gray-600">Custom menus designed around your preferences and dietary requirements</p>
            </div>

            <div class="text-center">
              <div class="w-16 h-16 bg-secondary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                </svg>
              </div>
              <h3 class="text-xl font-bold text-primary mb-3">Dedicated Service</h3>
              <p class="text-gray-600">Professional staff dedicated to your event for seamless service</p>
            </div>

            <div class="text-center">
              <div class="w-16 h-16 bg-secondary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" />
                </svg>
              </div>
              <h3 class="text-xl font-bold text-primary mb-3">Entertainment Options</h3>
              <p class="text-gray-600">Live music, DJs, and entertainment arrangements available</p>
            </div>

            <div class="text-center">
              <div class="w-16 h-16 bg-secondary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
              </div>
              <h3 class="text-xl font-bold text-primary mb-3">Event Planning</h3>
              <p class="text-gray-600">Full event coordination from initial planning to final details</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact Section -->
    <section class="py-16 lg:py-20 bg-primary text-white">
      <div class="container mx-auto px-4 text-center">
        <div class="max-w-3xl mx-auto">
          <h2 class="text-3xl lg:text-4xl font-bold mb-6">
            Ready to Plan Your Event?
          </h2>
          <p class="text-xl text-white/90 mb-8">
            Get in touch with our events team to discuss your requirements and receive a personalized quote.
          </p>
          
          {targetPub?.contactPhone && (
            <div class="mb-8">
              <a 
                href={`tel:${targetPub.contactPhone.replace(/\s/g, '')}`} 
                class="text-2xl font-bold text-secondary hover:text-secondary/90 transition-colors"
              >
                {targetPub.contactPhone}
              </a>
            </div>
          )}
          
          <div class="flex flex-wrap gap-4 justify-center">
            <Button size="lg" className="bg-secondary text-primary hover:bg-secondary/90">
              <a href="/contact">Contact Our Events Team</a>
            </Button>
            <Button variant="outline" size="lg" className="border-secondary text-secondary hover:bg-secondary hover:text-primary">
              <a href="/book-table">Book a Regular Table</a>
            </Button>
          </div>
        </div>
      </div>
    </section>
  </main>
</Layout>