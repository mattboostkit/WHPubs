---
import Layout from '../layouts/Layout.astro';
import { getDevelopmentKitchen, getPubBySlug } from '../lib/sanity';
import { Button } from '../components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../components/ui/card';
import { Badge } from '../components/ui/badge';
import { ImageGalleryModal } from '../components/ImageGalleryModal';
import SanityPortableText from '../components/SanityPortableText';

const targetPubSlug = import.meta.env.TARGET_PUB_SLUG;
const targetPub = targetPubSlug ? await getPubBySlug(targetPubSlug) : null;
const developmentKitchen = await getDevelopmentKitchen();

const pageTitle = 'Development Kitchen | WH Pubs';
const pageDescription = 'Discover the culinary innovation at the heart of WH Pubs. Our Development Kitchen creates seasonal menus using the finest local ingredients.';
---

<Layout 
  title={pageTitle} 
  description={pageDescription}
  targetPub={targetPub}
  ogImage={developmentKitchen?.seo?.ogImage?.asset?.url}
>
  <!-- Hero Section -->
  <section class="relative h-[70vh] min-h-[500px] overflow-hidden">
    {developmentKitchen?.heroImage && (
      <img 
        src={developmentKitchen.heroImage.asset.url} 
        alt={developmentKitchen.heroImage.alt}
        class="absolute inset-0 w-full h-full object-cover"
      />
    )}
    <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"></div>
    <div class="absolute inset-0 flex items-end">
      <div class="container mx-auto px-4 pb-16">
        <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4 leading-tight">Development Kitchen</h1>
        <p class="text-white/90 text-lg md:text-xl max-w-3xl">
          Where culinary innovation meets tradition. Our Development Kitchen is the creative heart of WH Pubs, 
          crafting seasonal menus that celebrate the finest local ingredients.
        </p>
      </div>
    </div>
  </section>

  <!-- Chef Profile Section with Journey -->
  {developmentKitchen?.chefProfile && (
    <section class="py-16 bg-background">
      <div class="container mx-auto px-4">
        <div class="max-w-5xl mx-auto">
          <div class="grid md:grid-cols-2 gap-12 items-start">
            {developmentKitchen.chefProfile.image && (
              <div>
                <div class="relative aspect-[4/5] overflow-hidden rounded-lg shadow-xl">
                  <img 
                    src={developmentKitchen.chefProfile.image.asset.url} 
                    alt={developmentKitchen.chefProfile.image.alt}
                    class="absolute inset-0 w-full h-full object-cover object-top"
                  />
                </div>
              </div>
            )}
            <div>
              <h2 class="text-4xl font-bold mb-2 text-primary">{developmentKitchen.chefProfile.name}</h2>
              <p class="text-xl text-muted-foreground mb-8">{developmentKitchen.chefProfile.title}</p>
              
              {/* Journey content directly under the title */}
              {developmentKitchen?.myJourney?.content && (
                <div class="prose prose-lg max-w-none">
                  <SanityPortableText value={developmentKitchen.myJourney.content} client:load />
                </div>
              )}
            </div>
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- What We Do Section -->
  {developmentKitchen?.whatWeDo && (
    <section class="py-16 bg-background">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-4xl font-bold mb-8 text-primary text-center">{developmentKitchen.whatWeDo.heading}</h2>
          <div class="grid md:grid-cols-2 gap-12 items-center">
            {developmentKitchen.whatWeDo.image && (
              <div class="relative aspect-[4/3] overflow-hidden rounded-lg shadow-xl">
                <img 
                  src={developmentKitchen.whatWeDo.image.asset.url} 
                  alt={developmentKitchen.whatWeDo.image.alt}
                  class="w-full h-full object-cover"
                />
              </div>
            )}
            <div class="prose prose-lg">
              {developmentKitchen.whatWeDo.content && (
                <SanityPortableText value={developmentKitchen.whatWeDo.content} client:load />
              )}
            </div>
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- Quality Sourcing Section -->
  {developmentKitchen?.qualitySourcing && (
    <section class="py-16 bg-muted/50">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-4xl font-bold mb-8 text-primary text-center">{developmentKitchen.qualitySourcing.heading}</h2>
          <div class="grid md:grid-cols-2 gap-12 items-center">
            <div class="prose prose-lg">
              {developmentKitchen.qualitySourcing.content && (
                <SanityPortableText value={developmentKitchen.qualitySourcing.content} client:load />
              )}
            </div>
            {developmentKitchen.qualitySourcing.image && (
              <div class="relative aspect-[4/3] overflow-hidden rounded-lg shadow-xl">
                <img 
                  src={developmentKitchen.qualitySourcing.image.asset.url} 
                  alt={developmentKitchen.qualitySourcing.image.alt}
                  class="w-full h-full object-cover"
                />
              </div>
            )}
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- Christmas Special Section -->
  {developmentKitchen?.christmasSpecial && (
    <section class="py-16 bg-background">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-4xl font-bold mb-8 text-primary text-center">{developmentKitchen.christmasSpecial.heading}</h2>
          <div class="grid md:grid-cols-2 gap-12 items-center">
            {developmentKitchen.christmasSpecial.image && (
              <div class="relative aspect-[4/3] overflow-hidden rounded-lg shadow-xl">
                <img 
                  src={developmentKitchen.christmasSpecial.image.asset.url} 
                  alt={developmentKitchen.christmasSpecial.image.alt}
                  class="w-full h-full object-cover"
                />
              </div>
            )}
            <div class="prose prose-lg">
              {developmentKitchen.christmasSpecial.content && (
                <SanityPortableText value={developmentKitchen.christmasSpecial.content} client:load />
              )}
            </div>
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- Handmade Burgers Section -->
  {developmentKitchen?.handmadeBurgers && (
    <section class="py-20 bg-gradient-to-b from-white to-muted/30">
      <div class="container mx-auto px-4">
        <div class="max-w-6xl mx-auto">
          {/* Section Header */}
          <div class="text-center mb-12">
            <h2 class="text-4xl md:text-5xl font-bold text-primary mb-3">
              {developmentKitchen.handmadeBurgers.heading || "Crafted by Hand, Made with Pride"}
            </h2>
            <p class="text-xl text-muted-foreground">
              {developmentKitchen.handmadeBurgers.subheading || "Every Burger Tells Our Story"}
            </p>
          </div>

          {/* Content and First Image Row */}
          <div class="grid lg:grid-cols-2 gap-12 mb-12 items-center">
            <div class="order-2 lg:order-1">
              {developmentKitchen.handmadeBurgers.content ? (
                <div class="prose prose-lg max-w-none">
                  <SanityPortableText value={developmentKitchen.handmadeBurgers.content} client:load />
                </div>
              ) : (
                <div class="space-y-4 text-lg text-gray-700">
                  <p>
                    At WH Pubs, we believe that exceptional burgers start with exceptional care. Every single burger 
                    served across our five pubs is handcrafted in our Development Kitchen, where our skilled chefs 
                    transform premium British beef into patties that are as individual as they are delicious.
                  </p>
                  <p>
                    We start with carefully selected cuts from local farms, grinding our meat fresh daily to ensure 
                    the perfect texture and flavour. Each patty is hand-formed with precision – never pressed too hard, 
                    allowing the meat to remain tender and juicy when cooked.
                  </p>
                  <p>
                    This isn't just about making burgers; it's about honouring the craft. From the gentle seasoning 
                    that enhances rather than masks the beef's natural flavour, to the careful temperature control 
                    that ensures each burger is cooked to perfection – every step is a testament to our commitment 
                    to quality.
                  </p>
                </div>
              )}
              
              {/* Key Highlights */}
              {developmentKitchen.handmadeBurgers.highlights && developmentKitchen.handmadeBurgers.highlights.length > 0 && (
                <div class="mt-8 grid grid-cols-2 gap-4">
                  {developmentKitchen.handmadeBurgers.highlights.map((highlight) => (
                    <div class="flex items-center gap-3 bg-white p-4 rounded-lg shadow-sm">
                      <svg class="w-5 h-5 text-secondary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                      </svg>
                      <span class="font-medium text-primary">{highlight}</span>
                    </div>
                  ))}
                </div>
              )}
            </div>
            
            {/* First Image */}
            <div class="order-1 lg:order-2">
              {developmentKitchen.handmadeBurgers.image1 ? (
                <figure>
                  <div class="relative aspect-[4/3] overflow-hidden rounded-xl shadow-2xl">
                    <img 
                      src={developmentKitchen.handmadeBurgers.image1.asset.url} 
                      alt={developmentKitchen.handmadeBurgers.image1.alt}
                      class="w-full h-full object-cover"
                    />
                  </div>
                  {developmentKitchen.handmadeBurgers.image1.caption && (
                    <figcaption class="mt-3 text-sm text-center text-muted-foreground italic">
                      {developmentKitchen.handmadeBurgers.image1.caption}
                    </figcaption>
                  )}
                </figure>
              ) : (
                <div class="aspect-[4/3] bg-muted rounded-xl flex items-center justify-center">
                  <p class="text-muted-foreground">Burger preparation image will appear here</p>
                </div>
              )}
            </div>
          </div>

          {/* Second Image and Additional Content */}
          <div class="grid lg:grid-cols-2 gap-12 items-center">
            {/* Second Image */}
            <div>
              {developmentKitchen.handmadeBurgers.image2 ? (
                <figure>
                  <div class="relative aspect-[4/3] overflow-hidden rounded-xl shadow-2xl">
                    <img 
                      src={developmentKitchen.handmadeBurgers.image2.asset.url} 
                      alt={developmentKitchen.handmadeBurgers.image2.alt}
                      class="w-full h-full object-cover"
                    />
                  </div>
                  {developmentKitchen.handmadeBurgers.image2.caption && (
                    <figcaption class="mt-3 text-sm text-center text-muted-foreground italic">
                      {developmentKitchen.handmadeBurgers.image2.caption}
                    </figcaption>
                  )}
                </figure>
              ) : (
                <div class="aspect-[4/3] bg-muted rounded-xl flex items-center justify-center">
                  <p class="text-muted-foreground">Burger preparation image will appear here</p>
                </div>
              )}
            </div>
            
            {/* The Promise */}
            <div class="bg-primary text-white p-8 rounded-xl">
              <h3 class="text-2xl font-bold mb-4 text-secondary">Our Burger Promise</h3>
              <div class="space-y-3">
                <p class="flex items-start gap-3">
                  <span class="text-secondary text-xl">•</span>
                  <span>100% British beef from trusted local suppliers</span>
                </p>
                <p class="flex items-start gap-3">
                  <span class="text-secondary text-xl">•</span>
                  <span>Hand-formed daily in our Development Kitchen</span>
                </p>
                <p class="flex items-start gap-3">
                  <span class="text-secondary text-xl">•</span>
                  <span>Never frozen, always fresh</span>
                </p>
                <p class="flex items-start gap-3">
                  <span class="text-secondary text-xl">•</span>
                  <span>Seasoned with our signature blend of herbs and spices</span>
                </p>
                <p class="flex items-start gap-3">
                  <span class="text-secondary text-xl">•</span>
                  <span>Cooked to order, just the way you like it</span>
                </p>
              </div>
              <p class="mt-6 text-secondary font-semibold">
                Because when you put this much care into every burger, you can taste the difference.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- Gallery Section -->
  {developmentKitchen?.gallery && developmentKitchen.gallery.length > 0 && (
    <section class="py-16 bg-muted/50">
      <div class="container mx-auto px-4">
        <h2 class="text-4xl font-bold text-center mb-12 text-primary">Behind the Scenes</h2>
        <ImageGalleryModal images={developmentKitchen.gallery} client:load />
      </div>
    </section>
  )}

</Layout>